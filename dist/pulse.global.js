"use strict";(()=>{var U=()=>{},u=Symbol("pulse(disposed)"),_=new Set,S=new Set,d="",T=!1,x=Date.now(),b="production";function N(t){b=t.mode}var v=class{constructor(e){this.callback=e}register(e,i){}unregister(e){}},z=globalThis.FinalizationRegistry||v,s={byId:new Map,gc:{get alive(){return s.gc.created-s.gc.finalized},get active(){return s.gc.created-s.gc.disposed},created:0,disposed:0,finalized:0,watcher:new z(t=>{s.gc.finalized=s.gc.finalized+1})},track(t){b==="debug"&&(s.byId.set(t.id,t),s.gc.watcher.register(t,t.id),s.gc.created=s.gc.created+1)},untrack(t){b==="debug"&&(s.byId.delete(t.id),s.gc.disposed=s.gc.disposed+1,s.gc.watcher instanceof v&&s.gc.watcher.callback(t.id))}};function F(t,e){let i=d;d=t+"_";let r=e();return d=i,r}function w(){return(x++).toString(36)}var R=t=>t instanceof f,Q=t=>t instanceof p,j=t=>t instanceof l;function k(){_.forEach(t=>{t()}),_.clear()}function B(){S.forEach(t=>{t()}),S.clear()}function m(...t){t.forEach(e=>{"dispose"in e?e.dispose():console.error("Cannot dispose",e)})}var a=class t{constructor(e,i){this.listener=e;this.callback=i}static current=null;static run(e,i){let r=new t(e,i),n=t.current;t.current=r,i(),t.current=n}};function E(t,e){t._signals.add(e)}function D(t,e,i=!1){t._signals.delete(e),i&&t.dispose()}function C(t,e){t._listeners.add(e)}function y(t,e,i){t._listeners.delete(e)}function L(t){t._notify()}var f=class{id=d+"S"+w();_value;_listeners=new Set;constructor(e){this._value=e,s.track(this)}peek(){return this._value}get=()=>{if(this._value===u)throw new Error("Signal is disposed");return a.current&&(C(this,a.current.listener),E(a.current.listener,this)),this._value};set(e,i=!1){return this._value!==e||i?(this._value=e,this._value===u?(this._listeners.forEach(r=>{D(r,this,!0)}),this._listeners.clear(),s.untrack(this),!1):(T?S.add(this._notify):(this._notify(),k()),!0)):!1}subscribe(e){return new l(()=>{e(this.get())})}dispose=()=>{this._value!==u&&this.set(u)};_notify=()=>{this._listeners.forEach(e=>{L(e)})};static internals(e){return{signal:e,_value:e._value,_listeners:e._listeners}}},p=class{constructor(e,i=!1){this._fn=e;s.track(this),i&&(this._value=this._fn())}id=d+"C"+w();_value;_isStale=!0;_signals=new Set;_listeners=new Set;peek(){return this._value}get=()=>{if(this._value===u)throw new Error("Computed is disposed");return this._isStale&&(this._signals.forEach(e=>{y(e,this)}),this._signals.clear(),a.current&&(C(this,a.current.listener),E(a.current.listener,this)),a.run(this,()=>{this._derive()})),this._value};subscribe(e){return new l(()=>{e(this.get())})}dispose=()=>{this._value!==u&&(this._listeners.forEach(e=>{D(e,this,!0)}),this._listeners.clear(),this._signals.forEach(e=>{y(e,this,!0)}),this._signals.clear(),this._value=u,s.untrack(this))};_derive(){this._value=this._fn(),this._isStale=!1}_notify(){this._isStale||(this._isStale=!0,this._listeners.forEach(e=>{L(e)}))}static internals(e){return{computed:e,_value:e._value,_isStale:e._isStale,_signals:e._signals,_listeners:e._listeners}}},l=class{constructor(e){this._fn=e;s.track(this),this._run()}id=d+"E"+w();_signals=new Set;_isStale=!0;_isDisposed=!1;_dispose=U;_run=()=>{if(this._isDisposed)return console.warn("Effect run skipped due to disposed");this._isStale&&(this._signals.forEach(e=>{y(e,this)}),this._signals.clear(),a.run(this,()=>{this._dispose=this._fn()||this._dispose})),this._isStale=!1};_notify(){this._isDisposed||this._isStale||(this._isStale=!0,_.add(this._run))}dispose=()=>{this._isDisposed||(this._isDisposed=!0,this._dispose(),this._signals.forEach(e=>{y(e,this,!0)}),this._signals.clear(),s.untrack(this))};static internals(e){return{effect:e,_signals:e._signals,_isStale:e._isStale,_isDisposed:e._isDisposed,_innerDispose:e._dispose}}};function I(t){T=!0;try{return t()}finally{T=!1,B(),k()}}function h(t){return new f(t)}function P(t,e=!1){return new p(t,e)}function O(t){return new l(t)}globalThis._pulse_={devTools:s,internals:{effectQueue:_,batchedUpdateQueue:S,get inBatch(){return T},get lastUid(){return x},get _idPrefx(){return d}},dispose:m,Signal:f,Computed:p,Effect:l,batch:I,signal:h,computed:P,effect:O};var J={storage:globalThis.localStorage,toStorage:JSON.stringify,fromStorage:JSON.parse};function V(t,e,i){let{storage:r,toStorage:n,fromStorage:g}={...J,...i};if(!r)return console.warn("No storage available, using regular signal",t),h(e);let c=r.getItem(t),o=h(c?g(c):e);return o.subscribe(K=>{r.setItem(t,n(K))}),o}function X(t,e,i=!1){let r=t.peek(),n=typeof e=="function"?e(r):e;if(typeof n!="object"||n===null)return t.set(n);{let c={...r,...n};return t.set(c),i?M(r,c):!0}}function M(t,e){let i=Reflect.ownKeys(t),r=Reflect.ownKeys(e),n=r.filter(o=>!i.includes(o)),g=i.filter(o=>!r.includes(o)),c=i.filter(o=>t[o]!==e[o]);return[...n,...g,...c]}})();
