import{e as l,f}from"../chunk-QN5SRUK7.js";var d={storage:globalThis.localStorage,toStorage:JSON.stringify,fromStorage:JSON.parse};function c(e,r,a){let{storage:t,toStorage:s,fromStorage:i}={...d,...a};if(!t)return console.warn("No storage available, using regular signal",e),l(r);let n=t.getItem(e),o=l(n?i(n):r);return f(()=>{let g=s(o.value),T=i(t.getItem(e));g!==T&&t.setItem(e,g)}),o}function p(e,r,a=!1){let t=e.peek(),s=typeof r=="function"?r(t):r;if(typeof s!="object"||s===null)return e.set(s);{let n={...t,...s};return e.set(n),a?S(t,n):void 0}}function S(e,r){let a=Reflect.ownKeys(e),t=Reflect.ownKeys(r),s=t.filter(o=>!a.includes(o)),i=a.filter(o=>!t.includes(o)),n=a.filter(o=>e[o]!==r[o]);return[...s,...i,...n]}export{c as persistedSignal,p as update};
